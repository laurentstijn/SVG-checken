<!DOCTYPE html>
<html>
<head>
  <title>SVG Opslaan met Onthouden Naam</title>
  <style>
    #mijnSVG {
      border: 1px solid #ccc;
      margin-top: 10px;
    }
  </style>

  <!-- Firebase SDK's -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
    import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

    // Firebase configuratie (vervang door jouw gegevens)
   const firebaseConfig = {
  apiKey: "AIzaSyBrvdXyuMpgkC4lFKjQDeHNihzFRbzMANU",
  authDomain: "tekensvg.firebaseapp.com",
  databaseURL: "https://tekensvg-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "tekensvg",
  storageBucket: "tekensvg.firebasestorage.app",
  messagingSenderId: "180262088073",
  appId: "1:180262088073:web:6470e50e3ad8a587ef8558"
  };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Variabele om bestandsnaam te onthouden
    let laatstGebruikteBestandsnaam = "";

    // === Functie: Slim opslaan + naam onthouden ===
    async function slimOpslaanSVG() {
      const svgElement = document.getElementById("mijnSVG");
      const serializer = new XMLSerializer();
      const svgString = serializer.serializeToString(svgElement);

      // Vraag om bestandsnaam, met vorige als suggestie
      const filename = prompt(
        "Geef een bestandsnaam op:",
        laatstGebruikteBestandsnaam || "tekening.svg"
      );

      if (!filename) {
        alert("Opslaan geannuleerd.");
        return;
      }

      const docRef = doc(db, "svg-files", filename);
      const bestaandDoc = await getDoc(docRef);

      if (bestaandDoc.exists()) {
        const overschrijf = confirm(`"${filename}" bestaat al. Overschrijven?`);
        if (!overschrijf) {
          alert("Wijzigingen niet opgeslagen.");
          return;
        }
      }

      // Sla SVG op in Firestore
      await setDoc(docRef, {
        filename,
        svg: svgString,
        timestamp: new Date().toISOString(),
      });

      // Onthoud naam voor volgende keer
      laatstGebruikteBestandsnaam = filename;

      alert(`SVG ${bestaandDoc.exists() ? "bijgewerkt" : "opgeslagen"} als '${filename}'`);
    }

    // Maak functie beschikbaar in de knop
    window.slimOpslaanSVG = slimOpslaanSVG;
  </script>
</head>
<body>

  <h2>SVG voorbeeld</h2>
  <svg id="mijnSVG" xmlns="http://www.w3.org/2000/svg" width="200" height="200">
    <circle cx="100" cy="100" r="80" fill="orange" />
  </svg>

  <br>
  <button onclick="slimOpslaanSVG()">Opslaan</button>

</body>
</html>
